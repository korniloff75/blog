<style>
input[type="text"], input[type="password"], select {
	width: 100%;
	max-width: 500px;
}
.uk-accordion-title {
	cursor: pointer;
}
body>#logWrapper {
	margin-left: 225px;
}
*[contenteditable="true"]{
	background-color: rgba(0, 0, 255, 0.151);
	outline: 1px solid blue;
	outline-offset: -1px;
}
*[contenteditable="true"]:hover{
	background-color: rgba(0, 0, 255, 0.055);
	outline: 1px solid blue;
	outline-offset: -1px;
}
*[contenteditable="true"]:focus{
	background-color: transparent;
	outline: 1px solid red;
	outline-offset: -1px;
}
</style>

<!-- <script src="/modules/ckeditor_plus/ckeditor/ckeditor.js"></script> -->
<!-- <script src="https://cdn.ckeditor.com/4.7.3/standard/ckeditor.js"></script> -->
<script src="/modules/ckeditor_4.5.8_standard/ckeditor/ckeditor.js"></script>

<h3>Глобальные настройки</h3>

<div id="kff_sts" class="uk-section .uk-section-primary uk-padding">
	<p><label>Префикс для модулей <input name="mds_prefix" type="text" value="<?= Basic::$cfg['mds_prefix']?>"></label></p>
	<p class="comment">Скрипт выбирает все модули с указанным префиксом. Например, папки искомых модулей должны называться как <b>kff_modulename</b>.</p>
	<label>Подключить внутренние модули <input name="kff" type="checkbox" <?= Basic::$cfg['copyModules']?'checked':''?>></label>
	<p class="comment">Поставленный флажок внедряет и инициализирует внутренние модули из папки ./modules. На данный момент там находятся модуль обратной связи и модуль подключения UIKit. Если какой-нибудь из подключённых модулей окажется повреждён или удалён -- флажок следует снять и снова поставить.</p>
	<p><label>Init Modules <input name="init_mods" type="checkbox" ></label></p>
	<p class="comment">Инициализация всех модулей. Системная.</p>
</div>


<script>
'use strict';
// kff.checkLib('jQuery')
// .then($=>{
$(()=>{
	// *Украшения
	$('#kff_sts input[type=checkbox]').addClass('uk-checkbox');

	// *Сохр глоб. настроек
	$('#kff_sts').on('change', 'input', $e=>{
		var $t= $($e.target);
		// console.log($t.prop('checked'));
		if(!$t.length) return;

		var val= $t.val() === 'on' ? $t.prop('checked') : $t.val();

		$.post('',{
			type: 'global',
			name: $t.prop('name'),
			val: val,
		}).then((response, status)=>{
			// console.log();
			$('<div/>').insertAfter($e.currentTarget)
			.html($(response).find('pre'));
		});
	});

	// *Сохр настроек модулей
	// console.log($('#mds_sts'));
	$('#mds_sts').on('change', 'input,textarea', $e=>{
		var $t= $($e.target);
		if(!$t.length) return;

		$.post('',{
			ini_path: $t.closest('li.uk-open').find('h4').data('ini-path'),
			name: $t.prev().text().trim(),
			val: $t.val(),
		}).then((response, status)=>{
			// console.log();
			$('<div/>').insertAfter($e.currentTarget)
			.html($(response).find('pre.log'));
		});
	});
});

CKEDITOR.inlineAll();
</script>